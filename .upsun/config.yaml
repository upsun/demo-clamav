applications:
  test-clamav:
    source:
      root: "/"
    stack:
      - "clamav"
    build:
      flavor: none

    mounts:
      'folder2scan':
        source: storage
        source_path: folder2scan
      'var':
        source: storage
        source_path: var

    hooks:
      build: |
        set -eux        

      deploy: |
        set -eux
        ./scripts/clam_install.sh

    crons:
      update-db:
        spec: '0 0 * * *'
        commands:
          start: ./scripts/clam_update-db.sh
          stop: pkill freshclam

      scan-files:
        spec: 'H * * * *'
        commands:
          start: ./scripts/clam_scan.sh
          stop: pkill clamscan

services: null
routes:
  # "https://{default}/":
  #   type: upstream
  #   upstream: "test-clamav:http"
